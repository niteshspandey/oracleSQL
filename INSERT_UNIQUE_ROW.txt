/*INSERT HINT
INSERT ONLY UNIQUE ROW FROM SOURCE TO TARGET USING IGNORE_ROW_ON_DUPKEY_INDEX IF PRIMARY CONSTRAINTS ALREADY APPICABLE ON TARGET TABLE
*/

CREATE TABLE EMP_SRC(EMP_NO NUMBER,EMP_NAME VARCHAR2(10));
CREATE TABLE EMP_TGT(EMP_NO NUMBER,EMP_NAME VARCHAR2(10));

INSERT INTO EMP_SRC VALUES(1,'NITESH');
INSERT INTO EMP_SRC VALUES(2,'SARVESH');
INSERT INTO EMP_SRC VALUES(3,'PANDEY');


INSERT INTO EMP_TGT VALUES(1,'NITESH');
INSERT INTO EMP_TGT VALUES(4,'TARA');
INSERT INTO EMP_TGT VALUES(5,'SAM');



SELECT * FROM EMP_SRC;
SELECT * FROM EMP_TGT;

ALTER TABLE EMP_SRC ADD CONSTRAINT PK_EMP_SRC_EMP_NO PRIMARY KEY(EMP_NO);
SELECT * FROM USER_CONSTRAINTS WHERE TABLE_NAME='EMP_SRC';
SELECT * FROM USER_INDEXES WHERE TABLE_NAME='EMP_SRC';

INSERT INTO EMP_SRC VALUES(1,'NITESH');--unique constraint (SYS.PK_EMP_SRC_EMP_NO) violated
--OR
INSERT INTO EMP_SRC SELECT * FROM EMP_TGT;

--SOLUTION OF ABOVE ISSUE OR ERROR
CLEAR SCREEN
INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(EMP_SRC(EMP_NO))*/
INTO EMP_SRC SELECT * FROM EMP_TGT;

SELECT * FROM EMP_SRC;


/*IF TABLE DOES NOT HAVE PRIMARY CONSTRAINTS THEN HOW TO ACHIEVE THE ABOVE SITUATION.*/

MERGE INTO EMP_TGT USING EMP_SRC ON (EMP_SRC.EMP_NO=EMP_TGT.EMP_NO)
WHEN NOT MATCHED THEN 
INSERT(EMP_NO,EMP_NAME) VALUES(EMP_SRC.EMP_NO,EMP_SRC.EMP_NAME);

--METHOD -2
INSERT INTO EMP_TGT
SELECT * FROM EMP_SRC
MINUS
SELECT * FROM EMP_TGT;

--METHOD-3
INSERT INTO EMP_TGT
SELECT * FROM EMP_SRC
WHERE EMP_NO NOT IN (SELECT EMP_NO FROM EMP_SRC);

